# 7.1 상태 머신 다이어그램

UML에서 상태와 상태 변화를 모델링하는 도구로 상태 머신 다이어그램이 있음  
모서리가 둥근 사각형으로 상태(state)를 나타내고 화살표를 이용해 상태 전이(state translate)를 나타냄

상태란?

> 객체가 시스템에 존재하는 동안, 즉 라이프 타임동안 객체가 가질 수 있는 어떤 조건이나 상황을 표현

UML 상태 머신 다이어그램에서 지원하는 의사 상태들로 initial, final, history, choice, junction, fork, join, entry point, exit point 등이 있음

흔히 볼 수 있는 것은 시작과 종료상태임 보통 시작 상태에서의 진입은 객체를 새로 생성하는 이베트만 명시하거나 아예 어떤것도 명시하지 않아야 함

상태진입은 객체의 한 상태에서 다른 상태로 이동하는 것을 말하며 보통 상태 진입은 특정 이벤트가 발생한 후 명세된 조건을 만족한 경우에 이루어짐

> '이벤트(인자 리스트)[조건]/액션' 으로 명세할 수 있으며 / 다음에 진입이 이루어지면서 수행되어야 하는 액션을 기술한다.

# 7.2 형광등 만들기

state 라는 필드에 on / off를 지정하고 이를 바꾸는 onButtonPushed(), offButtonPushed()로 이루어진 클래스를 생각해보자

# 7.3 문제점

형광등에 새로운 상태를 추가할 때, 예를 들어 취침등 상태를 추가하려면?

on,off 말고 sleeping 이라는 상태가 추가될 때 코드는 어떻게 확장하는가? 기존의 코드대로 라면 sleeping 필드가 하나 추가되고  
onButtonPushed()가 수정되어야 함

# 7.4 해결책

위 처럼 관련된 코드를 모두 변경하지 않고 무엇이 변하는지를 먼저 확인 지금 같은 경우는 state가 변하는 것임  
즉 상태를 클래스로 분리해 캡슐화하도록 해야함, 5장의 Strategy pattern과 매우 유사함 Light 클래스에서 구체적인 상태 클래스가 아닌 추상화된 State 인터페이스만 참조하므로 현재 어떤 상태에 있는지 무관하게 코드를 작성할 수 있음

# 7.5 State pattern

스테이트 패턴은 어떤 행위를 수행할 때 상태에 행위를 수행하도록 위임한다. 이를 위해 스테이트 패턴에서는 시스템의 각 상태를 클래스로 분리해 표현하고 각 클래스에서 수행하는 행위들을 메서드로 구현, 이러한 상태들을 외부로부터 캡슐화하기 위해 인터페이스를 만들어 시스템의 각 상태를 나타내는 클래스로 하여금 실체화하게 한다.
